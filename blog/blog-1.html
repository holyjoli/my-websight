<h4>Comments</h4>
<div id="comments">
</div>
<form>
  <label for="name">Name:</label><br>
  <input type="text" id="name" name="name"><br>
  <label for="text">Comment:</label><br>
  <input type="textarea" id="text" name="text">
  <button id="send">Send Comment</button>
</form>

<script>
  const userAction = async () => {
  const response = await fetch('https://joliroll.herokuapp.com/comments/2');
  const comments = await response.json(); //extract JSON from the http response
  for (var i = 0; i < comments.length; i++) {
    var comment = "<div>";
    comment += "<h5>" + comments[i].name + "</h5>";
    comment += new Date(parseInt(comments[i]._seconds)*1000).toLocaleDateString(); + "<br>";
    comment += comments[i].text + "<br>";

    comment += "</div>";
    document.getElementById('comments').innerHTML += comment;
  }
}
  userAction();
  
  document.getElementById("send").addEventListener("click", function()
  {
    var url = window.location.href.split("/");
    console.log(url);
    var request = new XMLHttpRequest();
    var path = "https://joliroll.herokuapp.com/comments/" + url[url.length - 1]; 
    request.open("POST", path, true); 
    request.setRequestHeader("Content-Type", "application/json; charset=UTF-8");
    var text= '{"name":"' + document.getElementById("name").value + '","text":"' + document.getElementById("text").value + '", "date":' + Date.now() + '"}';
    request.send ( text );
  });
</script>
